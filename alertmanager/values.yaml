alertmanager:
  enabled: true

  replicaCount: 1

  statefulSet:
    enabled: true

  persistence:
    enabled: true
    storageClass: standard
    accessModes:
      - ReadWriteOnce
    size: 2Gi

  service:
    type: NodePort
    port: 9093
    nodePort: 30903
    
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  config:
    global:
      resolve_timeout: 5m
      smtp_smarthost: "smtp.example.com:587"
      smtp_from: "alertmanager@example.com"
      smtp_auth_username: "alertmanager@example.com"
      smtp_auth_password: "SMTP_PASSWORD"

    route:
      receiver: "slack-notifications"
      group_by: ["alertname", "cluster"]
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 4h
      routes:
        - matchers:
            - severity="critical"
          receiver: "email-notifications"

    receivers:
      - name: "slack-notifications"
        slack_configs:
          - api_url: "https://hooks.slack.com/services/T000/B000/XXXX"
            channel: "#alerts"
            send_resolved: true
            title: "{{ .CommonAnnotations.summary }}"
            text: "{{ .CommonAnnotations.description }}"

      - name: "email-notifications"
        email_configs:
          - to: "oncall@example.com"
            send_resolved: true

    inhibit_rules:
      - source_matchers:
          - severity="critical"
        target_matchers:
          - severity="warning"
        equal: ["alertname", "cluster"]

  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "9093"
